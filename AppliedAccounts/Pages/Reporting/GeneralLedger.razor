@page "/Reporting/GL"
@attribute [Authorize]

@using AppReports
@using AppliedDB;
@using AppliedAccounts.Data;
@using AppliedAccounts.Models;
@using AppliedAccounts.Libs;
@using AppliedAccounts.Services;

@inject AuthenticationStateProvider Authorized
@inject ToastService ToastService
@inject PrintService ReportSeervice
@inject IJSRuntime js
@inject GlobalService GlobalService

@code {
    protected override void OnInitialized()
    {
        var AppUser = ((UserAuthonticationStateProvider)Authorized).AppUser;
        Globals = GlobalService;

        Start(AppUser);

        IsPageValid = true;
        if (Source is null) { IsPageValid = false; IsPageValidMessage += " Source is null"; }
        //if (ReportService is null) { IsPageValid = false; IsPageValidMessage += " Report Service is null"; }


    }
}

@if (IsPrinting)
{
    <div class="alert alert-primary d-flex align-items-center" role="alert">
        <div class="spinner-border text-primary me-2" role="status" aria-hidden="true"></div>
        <div>
            Loading data, please wait...
        </div>
    </div>
}


@if (IsPageValid)
{
    <div class="container d-flex justify-content-center">
        <div class="w-100">
            <div class="row g-2 p-1">
                <div class="col-3">
                    <div class="form-floating">
                        <InputDate id="DateFrom" class="form-control" @bind-Value="Date_From"></InputDate>
                        <label for="DateFrom">From</label>
                    </div>
                </div>
                <div class="col-3">
                    <div class="form-floating">
                        <InputDate id="DateTo" class="form-control" @bind-Value="Date_To"></InputDate>
                        <label for="DateFrom">To</label>
                    </div>
                </div>
            </div>
            <div class="row g-2 p-1">
                <div class="col-6">
                    <div class="form-floating">

                        <InputSelect id="coa_nature" @bind-Value="@COAID" class="form-control">
                            @foreach (var item in Accounts)
                            {
                                <option value=@item.ID>@item.Title</option>
                            }
                        </InputSelect>
                        <label for="coa_nature">Account Head</label>
                    </div>
                </div>
            </div>

            @if (!IsPrinting)
            {
                <div class="container control-buttons">
                    <div class="btn-group" role="group" aria-label="Navigation Buttons" id="printBtns">
                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.Print);})">
                            <i class="bi bi-printer"></i>
                        </button>

                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.Preview);})">
                            <i class="bi bi-search"></i>
                        </button>
                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.PDF);})">
                            <i class="bi bi-file-pdf"></i>
                        </button>
                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.Excel);})">
                            <i class="bi bi-file-earmark-excel"></i>
                        </button>
                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.Word);})">
                            <i class="bi bi-file-earmark-word"></i>
                        </button>
                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.HTML);})">
                            <i class="bi bi-filetype-html"></i>
                        </button>
                        <button type="button" class="btn ctrl ctrl-print" @onclick="(()=>{Print(ReportType.Image);})">
                            <i class="bi bi-file-earmark-image"></i>
                        </button>
                    </div>
                </div>
            }
        </div>
    </div>


}
else
{
    <div class="alert alert-danger" role="alert">
        <string>@IsPageValidMessage</string>
    </div>
}
