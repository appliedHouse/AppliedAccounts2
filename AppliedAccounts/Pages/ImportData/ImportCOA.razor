@page "/ImportCOA"
@using AppliedAccounts.Services
@attribute [Authorize]
@inject GlobalService AppGlobal


@code {
    public bool IsExcelLoaded { get; set; } = false;

    protected override void OnInitialized()
    {
        
    }

    private async Task TriggerFileInput()
    {
        await AppGlobal.JS.InvokeVoidAsync("triggerFileUpload");
    }

}

<ShowPageHeading PageTitle="Import Chart of Accounts"/>

@if(ShowSpinner)
{
   <h3>Spinner</h3>
}


@if(!IsExcelLoaded)
{

<div class="container">
    <div class="d-flex flex-row mb-3">
        <div class="p-2">
            <button class="btn btn-primary w1" disabled="@(IsExcelLoaded ? true : ShowSpinner)"
                    title="Upload Excel file" @onclick="TriggerFileInput">
                Upload Excel file
            </button>
            <InputFile id="inputFile" class="d-none" OnChange="GetExcelFile" />


        </div>
        <div class="p-2">
            <label>@ExcelFileName</label>
        </div>
        @if (IsExcelLoaded)
        {
            <div class="p-2">
                <label>Excel File has been loaded successfully.</label>
            </div>
        }

    </div>
    </div>
}
else
{
    <div class="alert alert-info" rolw="alert">
        File has been loaded
    </div>
    
}